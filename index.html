<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Para Mi Amor 🤍</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(
                135deg,
                #ffe6f2 5%,   /* rosa muy suave */
                #1e90ff 25%,  /* azul */
                #dc143c 45%,  /* rojo */
                #ffa500 65%,  /* naranja */
                #ffff66 85%,  /* amarillo claro */
                #8a2be2 100%  /* toque violeta */
            );
            background-size: 600% 600%;
            animation: gradientMove 12s ease infinite;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        @keyframes gradientMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1200px;
            width: 95%;
            margin: 20px auto;
        }

        .login-section {
            padding: 60px 40px;
            text-align: center;
            color: white;
        }

        .login-section h1 {
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .login-form {
            max-width: 400px;
            margin: 0 auto;
        }

        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 1.1em;
        }

        .input-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-row input, .input-row input[type="date"] {
            flex: 1;
            padding: 12px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            font-size: 1em;
            background: rgba(255,255,255,0.9);
        }

        .input-row input[type="date"] {
            color: #333;
            padding: 10px;
        }

        input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(0.5) sepia(1) saturate(5) hue-rotate(320deg);
            padding: 4px;
            cursor: pointer;
        }

        .hint-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.5);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .hint-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .hint-text {
            margin-top: 10px;
            padding: 10px;
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
            font-style: italic;
            display: none;
        }

        .login-btn {
            background: linear-gradient(45deg, #1e90ff, #0080ff);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .login-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(30, 144, 255, 0.4);
        }

        .error-msg {
            color: #ff4757;
            background: rgba(255,255,255,0.9);
            padding: 10px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
        }

        .letter-section {
            display: none;
            padding: 60px 40px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow:
                0 20px 40px rgba(0, 0, 0, 0.1),
                0 0 40px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .letter-title {
            text-align: center;
            color: #2d3436;
            font-size: 2.5em;
            margin-bottom: 40px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .audio-controls {
            text-align: center;
            margin-bottom: 40px;
        }

        .play-btn {
            background: linear-gradient(45deg, #b22222, #dc143c);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.95em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 10px;
        }

        .play-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(220, 20, 60, 0.4);
        }

        .play-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .letter-content {
            background: #ffffff;
            background-image: 
                /* Puntos vintage de papel viejo */
                radial-gradient(circle at 25% 25%, rgba(139, 69, 19, 0.15) 0.5px, transparent 0.5px),
                radial-gradient(circle at 75% 25%, rgba(101, 67, 33, 0.12) 0.8px, transparent 0.8px),
                radial-gradient(circle at 25% 75%, rgba(160, 82, 45, 0.1) 0.6px, transparent 0.6px),
                radial-gradient(circle at 75% 75%, rgba(139, 69, 19, 0.08) 0.4px, transparent 0.4px),
                /* Patrón de puntos más pequeños */
                radial-gradient(circle at 12.5% 12.5%, rgba(139, 69, 19, 0.08) 0.3px, transparent 0.3px),
                radial-gradient(circle at 37.5% 12.5%, rgba(101, 67, 33, 0.06) 0.2px, transparent 0.2px),
                radial-gradient(circle at 62.5% 12.5%, rgba(160, 82, 45, 0.05) 0.3px, transparent 0.3px),
                radial-gradient(circle at 87.5% 12.5%, rgba(139, 69, 19, 0.04) 0.2px, transparent 0.2px),
                radial-gradient(circle at 12.5% 37.5%, rgba(101, 67, 33, 0.07) 0.4px, transparent 0.4px),
                radial-gradient(circle at 87.5% 37.5%, rgba(160, 82, 45, 0.06) 0.3px, transparent 0.3px),
                radial-gradient(circle at 12.5% 62.5%, rgba(139, 69, 19, 0.05) 0.2px, transparent 0.2px),
                radial-gradient(circle at 87.5% 62.5%, rgba(101, 67, 33, 0.08) 0.5px, transparent 0.5px),
                radial-gradient(circle at 12.5% 87.5%, rgba(160, 82, 45, 0.09) 0.4px, transparent 0.4px),
                radial-gradient(circle at 37.5% 87.5%, rgba(139, 69, 19, 0.06) 0.3px, transparent 0.3px),
                radial-gradient(circle at 62.5% 87.5%, rgba(101, 67, 33, 0.07) 0.2px, transparent 0.2px),
                radial-gradient(circle at 87.5% 87.5%, rgba(160, 82, 45, 0.05) 0.4px, transparent 0.4px),
                /* Manchas vintage sutiles */
                radial-gradient(ellipse 150px 100px at 20% 30%, rgba(139, 69, 19, 0.03) 70%, transparent 70%),
                radial-gradient(ellipse 200px 120px at 80% 20%, rgba(101, 67, 33, 0.02) 60%, transparent 60%),
                radial-gradient(ellipse 180px 90px at 30% 80%, rgba(160, 82, 45, 0.025) 65%, transparent 65%),
                radial-gradient(ellipse 160px 110px at 75% 85%, rgba(139, 69, 19, 0.02) 55%, transparent 55%);
            background-size: 
                20px 20px, 25px 25px, 18px 18px, 22px 22px,
                10px 10px, 8px 8px, 12px 12px, 9px 9px,
                15px 15px, 11px 11px, 13px 13px, 16px 16px,
                14px 14px, 17px 17px, 19px 19px, 21px 21px,
                300px 200px, 350px 250px, 280px 180px, 320px 220px;
            padding: 60px 80px;
            margin: 30px auto;
            max-width: 95%;
            position: relative;
            line-height: 2.4;
            font-size: 1.3em;
            color: #2c1810;
            font-family: 'Georgia', 'Times New Roman', serif;
            font-weight: normal;
            box-shadow: 
                0 0 30px rgba(139, 69, 19, 0.15),
                inset 0 0 100px rgba(139, 69, 19, 0.05),
                0 8px 25px rgba(0, 0, 0, 0.1),
                inset 0 2px 4px rgba(139, 69, 19, 0.08),
                inset 0 -2px 4px rgba(101, 67, 33, 0.03);
            border-radius: 10px;
            text-align: justify;
            border: 1px solid rgba(139, 69, 19, 0.08);
        }

        .letter-text p {
           margin: 0.3em 0;
        }

        .letter-content::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background:
                linear-gradient(45deg,
                    #dc143c 0%,
                    #dc143c 100%);
            border-radius: 15px;
            z-index: -1;
            filter: blur(2px);
            opacity: 0.7;
        }

        .letter-content::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                /* Efecto de papel antiguo con más sutileza */
                radial-gradient(circle at 15% 25%, rgba(139, 69, 19, 0.03) 1px, transparent 1px),
                radial-gradient(circle at 85% 35%, rgba(101, 67, 33, 0.02) 1px, transparent 1px),
                radial-gradient(circle at 45% 75%, rgba(160, 82, 45, 0.025) 1px, transparent 1px);
            background-size: 30px 30px, 35px 35px, 40px 40px;
            border-radius: 8px;
            pointer-events: none;
        }

        .phrase {
            cursor: pointer;
            transition: all 0.2s ease;
            padding: 2px 1px;
            border-radius: 3px;
        }

        .phrase:hover {
            background-color: rgba(220, 20, 60, 0.3);
            color: #dc143c;
        }

        .phrase.playing {
            background-color: rgba(220, 20, 60, 0.5);
            color: #dc143c;
            font-weight: normal;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .hearts {
            text-align: center;
            font-size: 2em;
            margin: 30px 0;
            animation: heartbeat 2s infinite;
        }

        @keyframes heartbeat {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .signature {
            text-align: right;
            margin-top: 40px;
            font-style: italic;
            color: #636e72;
            font-size: 1.1em;
        }

        .floating-hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .floating-heart {
            position: absolute;
            font-size: 20px;
            color: #dc143c;
            animation: floatUp 3s ease-out forwards;
        }

        @keyframes floatDown {
            0% {
                opacity: 1;
                transform: translateY(0) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translateY(100px) rotate(360deg);
            }
        }

        @keyframes floatLeft {
            0% {
                opacity: 1;
                transform: translateX(0) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translateX(-100px) rotate(360deg);
            }
        }

        @keyframes floatRight {
            0% {
                opacity: 1;
                transform: translateX(0) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translateX(100px) rotate(360deg);
            }
        }

        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) rotate(360deg);
            }
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(220, 20, 60, 0.2);
            border-radius: 2px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #dc143c, #ff1744);
            border-radius: 2px;
            width: 0%;
            transition: width 0.1s ease;
        }

        @media (max-width: 600px) {
            .container {
                margin: 10px;
            }
            
            .login-section, .letter-section {
                padding: 40px 20px;
            }
            
            .letter-content {
                padding: 20px;
                font-size: 1.1em;
            }

            .letter-title {
                font-size: 2em;
            }
        }

        /* Contenedor de cerezas que aparecen al hacer clic */
        .cursor-cherries {

            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1500;
        }


        .click-cherry {
            position: absolute;
 
            animation: floatUpSmall 1.5s ease-out forwards;
        }

        @keyframes floatUpSmall {
            0% {
                opacity: 1;
                transform: translateY(0) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translateY(-60px) rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sección de Login -->
        <div class="login-section" id="loginSection">
            <h1>🤍 Ingresa con Cariño 🤍</h1>
            <div class="login-form">
                <div class="input-group">
                    <label>Usuario:</label>
                    <div class="input-row">
                        <input type="text" id="username" placeholder="Introduce el usuario">
                        <button class="hint-btn" onclick="toggleHint('userHint')">Pista</button>
                    </div>
                    <div class="hint-text" id="userHint">Mi dni</div>
                </div>
                
                <div class="input-group">
                    <label>Contraseña:</label>
                    <div class="input-row">
                        <input type="date" id="password" min="2020-01-01" max="2030-12-31" value="2025-05-01">
                        <button class="hint-btn" onclick="toggleHint('passHint')">Pista</button>
                    </div>
                    <div class="hint-text" id="passHint">Nuestro aniversario</div>
                </div>
                
                <button class="login-btn" onclick="attemptLogin()">🤍 Entrar 🤍</button>
                <div class="error-msg" id="errorMsg">¡Datos incorrectos! Inténtalo de nuevo 🤍</div>
            </div>
        </div>

        <!-- Sección de la Carta -->
        <div class="letter-section" id="letterSection">
            <h1 class="letter-title">💌 Para Ti, Mi Amor 💌</h1>
            
            <div class="audio-controls">

                <button class="play-btn" id="playBtn" onclick="playFullAudio()">🤍 Escuchar con la voz del futuro padre de tus hijos</button>


                <button class="play-btn" id="pauseBtn" onclick="pauseAudio()" style="display: none;">⏸️ Pausar</button>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
            
            <div class="letter-content">
                <div id="letterText" class="letter-text">
                    <!-- El texto se generará dinámicamente con JavaScript -->
                </div>
                

                <div class="hearts">🤍 🤍 🤍</div>
                

                
                <div class="signature">
                    Con todo mi amor,<br>
                    Adrián, para ti, mi vida, mi amor jijijiji 🤍
                </div>
            </div>
        </div>
    </div>

    <div class="floating-hearts" id="floatingHearts"></div>
    <div class="cursor-cherries" id="cursorCherries"></div>
    <audio id="bgAudio" preload="auto"></audio>

    <script>
        // Texto de la carta de ejemplo
        const letterText = `Amor mío, mi amor, mi vida, Marta.
Gorda, hoy es un día muy especial. Tu cumpleaños.
Llevamos casi dos meses juntos y a veces pienso que el destino tenía guardado nuestro amor desde hace mucho tiempo.
Qué suerte la mía, porque me regaló a la persona más maravillosa y guapa que he conocido. Tú.
Desde que entraste en mi vida todo ha cambiado. Me has dado paz, ilusión, alegría y ese amor que creía que sólo existía en las películas.
Contigo todo es más bonito, más real.
Tu risa se ha convertido en mi sonido favorito.
Tus abrazos y tus besos son mi lugar seguro.
Y tus ojos, tus ojos son ese lugar donde me pierdo y al mismo tiempo me encuentro a mí mismo y podría estar mirándolos toda la vida sin pestañear.
Te admiro tanto. Me encanta la forma en que te entregas a todo lo que haces.
Tu pasión por ayudar a los animales, tus ganas de aprender, tu constancia en el básquet como jugadora y entrenadora.
Eres un ejemplo de persona y cada día me siento más orgulloso de caminar a tu lado.
Y quiero que sepas algo que no sólo siento, sino que tengo clarísimo.
Quiero un futuro contigo.
Todo mi futuro. Quiero levantarme cada mañana a tu lado.
Quiero acompañarte en cada paso que des, celebrar tus logros, abrazarte en tus días tristes, cuidarte siempre.
Quiero formar una familia contigo, tener una vida que construyamos juntos con amor y lealtad.
No tengas nunca dudas de lo que siento por ti. No importa lo que pase, siempre estaré ahí, contigo, para ti.
No hay un solo día en que no agradezca tenerte.
Eres el amor de mi vida y lo único que quiero es hacerte feliz, protegerte y que nunca te falte amor.
Y bueno, esta carta la estoy escribiendo justo antes de subir al examen del carnet de conducir, así que si todo va bien, espero haber aprobado para poder llevarte donde quieras, mi copilota favorita.
Y si no, bueno, no pasa nada, te compro yo un coche y me ayudas a mí, que para eso era la que ya tiene carnet.
Te amo, Marta, con todo mi corazón.
Feliz cumpleaños, mi amor.
Gracias por existir, por quererme, por hacerme sentir que todo tiene sentido cuando estás cerca.
Siempre tuyo, ahora y en el futuro.
El futuro padre de tus hijos.`;

        const phraseTimestamps = [
            0, 4, 9, 16, 23, 31, 34, 37, 39,
            49, 54, 60, 66, 70, 72, 76, 83,
            88, 97, 99, 106, 118, 125, 128,
            129, 135, 138
        ];

         // Música de fondo local con lista de reproducción
        const bgAudio = document.getElementById('bgAudio');
        const playlist = ['perfect.mp3', 'inthestars.mp3', 'melendi.mp3', 'laplena.mp3'];
        let currentTrack = 0;
        bgAudio.src = playlist[currentTrack];
        bgAudio.volume = 0.15;
        bgAudio.volume = 0.15;


        bgAudio.addEventListener('ended', () => {
            currentTrack = (currentTrack + 1) % playlist.length;
            bgAudio.src = playlist[currentTrack];
            bgAudio.play().catch(() => {});
        });

        function playBackgroundMusic() {
            bgAudio.play().catch(() => {});
        }
        function pauseBackgroundMusic() {
            bgAudio.pause();
        }
        function resumeBackgroundMusic() {
            if (bgAudio.paused) {
                bgAudio.play().catch(() => {});
            }
        }

        // Audio de la carta
        const voiceAudio = new Audio('voice.mp3');
        voiceAudio.addEventListener('ended', () => {
            stopAudio();
            resumeBackgroundMusic();
        });

        // Variables para la reproducción
        let currentTimeSim = 0;
        const totalPhrases = phraseTimestamps.length;
        let currentAudio = null;
        let isPlaying = false;
        let currentPhraseIndex = 0;

        function initializeLetter() {
            const letterContainer = document.getElementById('letterText');

            const phrases = letterText.trim().split(/\n+/);
            let htmlContent = '';

            phrases.forEach((phrase, idx) => {
                htmlContent += `<p class="phrase" onclick="playFromPhrase(${idx})">${phrase}</p>`;
            });

            letterContainer.innerHTML = htmlContent;
            createFloatingHearts();
        }

        function createFloatingHearts() {
            const heartsContainer = document.getElementById('floatingHearts');

            setInterval(() => {
                if (isPlaying) {
                    const heart = document.createElement('div');
                    heart.className = 'floating-heart';
                    heart.innerHTML = ['🤍', '❤️', '♥️', '❣️'][Math.floor(Math.random() * 4)];

                    const directions = ['up', 'down', 'left', 'right'];
                    const dir = directions[Math.floor(Math.random() * directions.length)];

                    switch (dir) {
                        case 'up':
                            heart.style.left = Math.random() * window.innerWidth + 'px';
                            heart.style.bottom = '0px';
                            heart.style.animationName = 'floatUp';
                            break;
                        case 'down':
                            heart.style.left = Math.random() * window.innerWidth + 'px';
                            heart.style.top = '0px';
                            heart.style.animationName = 'floatDown';
                            break;
                        case 'left':
                            heart.style.top = Math.random() * window.innerHeight + 'px';
                            heart.style.right = '0px';
                            heart.style.animationName = 'floatLeft';
                            break;
                        case 'right':
                            heart.style.top = Math.random() * window.innerHeight + 'px';
                            heart.style.left = '0px';
                            heart.style.animationName = 'floatRight';
                            break;
                    }

                    heartsContainer.appendChild(heart);

                    setTimeout(() => {
                        heart.remove();
                    }, 3000);
                }
            }, 700);
        }

        function updateProgressBar() {
            const progressFill = document.getElementById('progressFill');
            const progress = (currentPhraseIndex / totalPhrases) * 100;
            progressFill.style.width = progress + '%';
        }

        function toggleHint(hintId) {
            const hint = document.getElementById(hintId);
            hint.style.display = hint.style.display === 'block' ? 'none' : 'block';
        }

        function attemptLogin() {
            const username = document.getElementById('username').value;
            const passwordInput = document.getElementById('password');
            const errorMsg = document.getElementById('errorMsg');

            // Verificar credenciales
            if (username === '49460586Y' && passwordInput.value === '2025-05-05') {
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('letterSection').style.display = 'block';
                initializeLetter();
                playBackgroundMusic();
                
                // Efecto de corazones al entrar
                setTimeout(() => {
                    for (let i = 0; i < 10; i++) {
                        setTimeout(() => {
                            createSingleHeart();
                        }, i * 200);
                    }
                }, 500);
            } else {
                errorMsg.style.display = 'block';
                setTimeout(() => {
                    errorMsg.style.display = 'none';
                }, 3000);
            }
        }

        function createSingleHeart() {
            const heartsContainer = document.getElementById('floatingHearts');
            const heart = document.createElement('div');
            heart.className = 'floating-heart';

            heart.innerHTML = '🤍';

            const directions = ['up', 'down', 'left', 'right'];
            const dir = directions[Math.floor(Math.random() * directions.length)];

            switch (dir) {
                case 'up':
                    heart.style.left = Math.random() * window.innerWidth + 'px';
                    heart.style.bottom = '0px';
                    heart.style.animationName = 'floatUp';
                    break;
                case 'down':
                    heart.style.left = Math.random() * window.innerWidth + 'px';
                    heart.style.top = '0px';
                    heart.style.animationName = 'floatDown';
                    break;
                case 'left':
                    heart.style.top = Math.random() * window.innerHeight + 'px';
                    heart.style.right = '0px';
                    heart.style.animationName = 'floatLeft';
                    break;
                case 'right':
                    heart.style.top = Math.random() * window.innerHeight + 'px';
                    heart.style.left = '0px';
                    heart.style.animationName = 'floatRight';
                    break;
            }

            heartsContainer.appendChild(heart);

            setTimeout(() => {
                heart.remove();
            }, 3000);
        }

        function playFullAudio() {
            if (isPlaying) {
                pauseAudio();
                return;
            }

            pauseBackgroundMusic();
            voiceAudio.currentTime = 0;
            voiceAudio.play().catch(() => {});
            simulateAudioPlayback();
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(45deg, #dc143c, #ff1744);
                color: white;
                padding: 30px;
                border-radius: 15px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                z-index: 10000;
                text-align: center;
                font-size: 1.1em;
                max-width: 400px;
                animation: fadeIn 0.3s ease;
            `;
            notification.innerHTML = `
                <div style="margin-bottom: 20px;">${message}</div>
                <button onclick="this.parentElement.remove()" style="
                    background: rgba(255,255,255,0.2);
                    border: 2px solid white;
                    color: white;
                    padding: 10px 20px;
                    border-radius: 25px;
                    cursor: pointer;
                    font-size: 1em;
                ">🤍 Entendido</button>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }

        function simulateAudioPlayback() {
            const playBtn = document.getElementById('playBtn');
            const pauseBtn = document.getElementById('pauseBtn');
            
            playBtn.style.display = 'none';
            pauseBtn.style.display = 'inline-block';
            isPlaying = true;
            currentPhraseIndex = 0;
            currentTimeSim = 0;

            const phraseElements = document.querySelectorAll('.phrase');

            const interval = setInterval(() => {
                currentTimeSim += 0.1;

                if (currentPhraseIndex + 1 < phraseTimestamps.length && currentTimeSim >= phraseTimestamps[currentPhraseIndex + 1]) {
                    phraseElements[currentPhraseIndex].classList.remove('playing');
                    currentPhraseIndex++;
                }

                phraseElements[currentPhraseIndex].classList.add('playing');
                updateProgressBar();

                if (currentPhraseIndex === phraseTimestamps.length - 1 && currentTimeSim >= phraseTimestamps[phraseTimestamps.length - 1] + 3) {
                    clearInterval(interval);
                    phraseElements[currentPhraseIndex].classList.remove('playing');
                    stopAudio();
                }
            }, 100);

            currentAudio = interval;
        }

        function pauseAudio() {
            if (currentAudio) {
                clearInterval(currentAudio);
                currentAudio = null;
            }

            voiceAudio.pause();
            resumeBackgroundMusic();

            const phraseElements = document.querySelectorAll('.phrase');
            phraseElements.forEach(p => p.classList.remove('playing'));
            
            document.getElementById('playBtn').style.display = 'inline-block';
            document.getElementById('pauseBtn').style.display = 'none';
            isPlaying = false;
        }

        function stopAudio() {
            if (currentAudio) {
                clearInterval(currentAudio);
                currentAudio = null;
            }

            voiceAudio.pause();
            voiceAudio.currentTime = 0;
            resumeBackgroundMusic();

            const phraseElements = document.querySelectorAll('.phrase');
            phraseElements.forEach(p => p.classList.remove('playing'));
            
            document.getElementById('playBtn').style.display = 'inline-block';
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('progressFill').style.width = '0%';
            isPlaying = false;
            currentPhraseIndex = 0;
        }

        function playFromPhrase(index) {
            stopAudio();

            const timestamp = phraseTimestamps[index];
            showNotification(`🎵 Aquí saltaría al segundo ${timestamp.toFixed(1)} de tu audio, donde empieza esta frase.\n\nCuando tengas el audio real, esto funcionará automáticamente.`);

            simulatePlaybackFromPhrase(index);
        }

        function simulatePlaybackFromPhrase(startIndex) {
            const phraseElements = document.querySelectorAll('.phrase');
            currentPhraseIndex = startIndex;
            currentTimeSim = phraseTimestamps[startIndex];

            phraseElements.forEach(p => p.classList.remove('playing'));

            const interval = setInterval(() => {
                currentTimeSim += 0.1;

                if (currentPhraseIndex + 1 < phraseTimestamps.length && currentTimeSim >= phraseTimestamps[currentPhraseIndex + 1]) {
                    phraseElements[currentPhraseIndex].classList.remove('playing');
                    currentPhraseIndex++;
                }

                phraseElements[currentPhraseIndex].classList.add('playing');
                updateProgressBar();

                if (currentPhraseIndex === phraseTimestamps.length - 1 && currentTimeSim >= phraseTimestamps[phraseTimestamps.length - 1] + 3) {
                    clearInterval(interval);
                    phraseElements[currentPhraseIndex].classList.remove('playing');
                    stopAudio();
                }
            }, 100);

            currentAudio = interval;
            document.getElementById('playBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'inline-block';
            isPlaying = true;
        }

        // Permitir login con Enter
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && document.getElementById('loginSection').style.display !== 'none') {
                attemptLogin();
            }
        });


        document.addEventListener('click', (e) => {
            const cherriesContainer = document.getElementById('cursorCherries');
            const cherry = document.createElement('div');
            cherry.className = 'click-cherry';
            cherry.textContent = '🍒';
            cherry.style.left = e.clientX + 'px';
            cherry.style.top = e.clientY + 'px';
            cherriesContainer.appendChild(cherry);
            setTimeout(() => cherry.remove(), 1500);

        });

        // Agregar estilo de animación fadeIn
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from { opacity: 0; transform: translate(-50%, -60%); }
                to { opacity: 1; transform: translate(-50%, -50%); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
